# 微動アレイ観測解析手法 - 技術ノート

## 1. 微動アレイ観測の基礎理論

### 1.1 微動とは
微動（microtremor）は、地盤に常時存在する微小振動であり、主に以下の要因により発生する：
- 海洋波浪（脈動：0.1-1 Hz）
- 交通振動（1-20 Hz）
- 風による構造物の振動
- 人間活動による振動

### 1.2 表面波の分散性
微動の主成分は表面波（レイリー波）であり、その位相速度は周波数（または波長）に依存する。この分散性により、地下構造を推定することが可能となる。

位相速度 c(f) と波長 λ の関係：
```
c(f) = f × λ
```

探査深度の目安：
```
探査深度 ≈ λ/2 ～ λ/3
```

## 2. SPAC法（空間自己相関法）

### 2.1 理論的背景
SPAC法（Spatial Autocorrelation Method）は、Aki (1957) により提案された手法で、微動の空間的な相関を利用して位相速度を推定する。

### 2.2 基本原理
円形アレイ（中心点＋周辺観測点）での観測データから、空間自己相関係数を計算：

```
ρ(r, f) = 2 * Re[S₁₂(f)] / √(S₁₁(f) * S₂₂(f))
```

ここで：
- S₁₂(f): クロススペクトル
- S₁₁(f), S₂₂(f): オートスペクトル
- r: 観測点間距離

### 2.3 位相速度の推定
空間自己相関係数は第1種0次ベッセル関数で表現される：

```
ρ(r, f) = J₀(2πrf/c(f))
```

これを逆解析することで位相速度 c(f) を求める。

### 2.4 実装上の注意点
1. **時間窓の設定**：10-30分程度の連続記録を使用
2. **セグメント分割**：20-40秒程度に分割し、平均化
3. **窓関数**：Hanning窓などを適用してスペクトルリーケージを低減
4. **ノイズ除去**：過渡的なノイズを含むセグメントは除外

## 3. FK法（周波数-波数法）

### 3.1 理論的背景
FK法（Frequency-Wavenumber Method）は、アレイ観測データを周波数-波数領域で解析し、表面波の伝播方向と位相速度を推定する。

### 3.2 基本原理
観測データ u(x, t) のフーリエ変換：

```
U(k, ω) = ∫∫ u(x, t) exp(-i(kx - ωt)) dx dt
```

パワースペクトル密度：
```
P(k, ω) = |U(k, ω)|²
```

### 3.3 ビームフォーミング
最大尤度法やビームフォーミングにより、各周波数での卓越波数を推定：

```
c(f) = 2πf / |k_max|
```

## 4. 分散曲線の算出と品質管理

### 4.1 分散曲線の結合
- 異なるアレイサイズからの結果を結合
- 周波数帯域の重複部分で連続性を確認

### 4.2 品質評価指標
1. **信号対雑音比（SNR）**
2. **空間自己相関係数の標準偏差**
3. **FK解析でのピークの明瞭度**

### 4.3 異常値の除去
- 物理的に不合理な速度値（例：表層より深部で低速）
- 隣接周波数との不連続性が大きい点

## 5. 逆解析手法

### 5.1 地下構造モデルの構築
初期モデルの設定：
- 層数、層厚、S波速度、P波速度、密度
- 既存の地質情報や物理探査結果を参考

### 5.2 順解析
レイリー波の理論分散曲線の計算：
- Thomson-Haskell法
- 反射透過係数法
- 有限要素法

### 5.3 最適化手法
1. **遺伝的アルゴリズム（GA）**
   - グローバルサーチに適している
   - 計算時間が長い

2. **シミュレーテッドアニーリング（SA）**
   - 局所解に陥りにくい
   - パラメータ調整が重要

3. **最小二乗法**
   - 収束が速い
   - 初期値依存性が高い

### 5.4 誤差評価
観測分散曲線と理論分散曲線の残差：

```
misfit = √(Σ[(c_obs - c_cal)² / σ²] / N)
```

## 6. 実装上のトラブルシューティング

### 6.1 一般的な問題と対策

1. **低周波数でのSPAC係数の不安定性**
   - 原因：アレイサイズが波長に対して小さい
   - 対策：より大きなアレイを使用、または解析下限周波数を上げる

2. **高周波数でのコヒーレンスの低下**
   - 原因：局所的な不均質性、非平面波の影響
   - 対策：観測点間隔を狭める、平均化時間を長くする

3. **分散曲線の不連続**
   - 原因：モード判定の誤り、ノイズの影響
   - 対策：隣接周波数との連続性をチェック、品質の低いデータを除外

### 6.2 データ処理のベストプラクティス

1. **前処理**
   - 機器応答の補正
   - トレンド除去（線形・多項式）
   - バンドパスフィルタの適用

2. **品質管理**
   - 時系列データの目視確認
   - スペクトルの安定性チェック
   - 複数手法での結果比較

3. **解釈上の注意**
   - 高次モードの影響
   - 横方向不均質性の影響
   - 解の非唯一性

## 7. 参考文献と推奨リソース

### 基本文献
- Aki, K. (1957): Space and time spectra of stationary stochastic waves
- Okada, H. (2003): The Microtremor Survey Method, SEG

### 解析ソフトウェア
- Geopsy (オープンソース)
- MASW (商用)
- 自作コード（Python/MATLAB）

### データフォーマット
- SEG-Y, SAC, MiniSEED
- 時刻同期の重要性（GPS時刻推奨）